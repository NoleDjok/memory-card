"use strict";
/*!@license
 * Copyright (c) Arkadium Inc - All Rights Reserved
 * Unauthorized copying of this file, via any medium is strictly prohibited
 * Proprietary and confidential
 * Written by Denis Gusarov <denis.gusarov@arkadium.com>
 */var __decorate=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(i<3?o(a):3<i?o(t,n,a):o(t,n))||a);return 3<i&&a&&Object.defineProperty(t,n,a),a},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__spreadArrays=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r};Object.defineProperty(exports,"__esModule",{value:!0});var Linq_1=require("../../Linq/Linq"),expandFunc_1=require("../expandFunc"),underscore_1=require("../../Utils/underscore"),GamePerformance_1=require("../../GamePerformance"),ModelEventItem=function(){function e(e,t,n){this._event=e,this._viewName=t,this.disposed=!1;var r=this;this.event=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r.disposed||(n.log.apply(n,__spreadArrays([r._viewName,"ModelEvent",r.name],e)),r.run.apply(r,e))}}return e.prototype.run=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._event.apply(this,e)},__decorate([GamePerformance_1.GamePerformanceMethod("ModelEventItem","Model event"),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",void 0)],e.prototype,"run",null),e}();exports.ModelEventItem=ModelEventItem;var ModelEventsList=function(){function e(e){this._modelEvents=e,this.items=new Linq_1.List}return e.prototype.get=function(e){return this[e]},e.prototype.initialize=function(e,o,i,a){var s=this;underscore_1._u.each(e,function(e,t){if(null!=i&&null!=i){var n=expandFunc_1.expandFunc(e,o),r=new ModelEventItem(n,o.locator,a);r.key=t,r.model=i,s.items.Add(r),s[t]=r,s._modelEvents.on(i,r.key,r.event,o)}else console.error(s.constructor.name+": error $model is null for event '"+t+"'")},this)},e.prototype.dispose=function(){var t=this;this.items.ForEach(function(e){e.disposed=!0,t._modelEvents.off(e.model,e.key,e.event)})},e}();exports.ModelEventsList=ModelEventsList;