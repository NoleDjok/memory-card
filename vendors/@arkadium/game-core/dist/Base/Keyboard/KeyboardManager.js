"use strict";
/*!@license
 * Copyright (c) Arkadium Inc - All Rights Reserved
 * Unauthorized copying of this file, via any medium is strictly prohibited
 * Proprietary and confidential
 * Written by Denis Gusarov <denis.gusarov@arkadium.com>
 */var __extends=this&&this.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};return function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),__decorate=this&&this.__decorate||function(e,t,n,o){var s,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;0<=a;a--)(s=e[a])&&(r=(i<3?s(r):3<i?s(t,n,r):s(t,n))||r);return 3<i&&r&&Object.defineProperty(t,n,r),r},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0});var HotKey_1=require("./HotKey"),typescript_ioc_1=require("../../IoC/typescript-ioc");function _isArray(e){return"[object Array]"===Object.prototype.toString.call(e)}var KeyboardManager=function(t){function e(){var e=t.call(this)||this;return e.isEnabled=!1,e._pressedKeys=[],e._releasedKeys=[],e._downKeys=[],e._hotKeys=[],e._preventDefaultKeys=[],e}return __extends(e,t),e.prototype.enable=function(){this.isEnabled||(this.isEnabled=!0,this._enableEvents())},e.prototype._enableEvents=function(){window.addEventListener("keydown",this._onKeyDown.bind(this),!0),window.addEventListener("keyup",this._onKeyUp.bind(this),!0)},e.prototype.disable=function(){this.isEnabled&&(this.isEnabled=!1,this._disableEvents())},e.prototype._disableEvents=function(){window.removeEventListener("keydown",this._onKeyDown,!0),window.removeEventListener("keyup",this._onKeyUp,!0)},e.prototype.setPreventDefault=function(e,t){if(void 0===t&&(t=!0),_isArray(e))for(var n=0;n<e.length;n++)this._preventDefaultKeys[e[n]]=t;else this._preventDefaultKeys[e]=t},e.prototype._onKeyDown=function(e){var t=e.which||e.keyCode;this._preventDefaultKeys[t]&&e.preventDefault(),this.isDown(t)||(this._downKeys.push(t),this._pressedKeys[t]=!0,this.emit("pressed",t))},e.prototype._onKeyUp=function(e){var t=e.which||e.keyCode;if(this._preventDefaultKeys[t]&&e.preventDefault(),this.isDown(t)){this._pressedKeys[t]=!1,this._releasedKeys[t]=!0;var n=this._downKeys.indexOf(t);-1!==n&&this._downKeys.splice(n,1),this.emit("released",t)}},e.prototype.isDown=function(e){return-1!==this._downKeys.indexOf(e)},e.prototype.isPressed=function(e){return!!this._pressedKeys[e]},e.prototype.isReleased=function(e){return!!this._releasedKeys[e]},e.prototype.update=function(){for(var e in this._hotKeys)this._hotKeys[e].update();for(var t=0;t<this._downKeys.length;t++)this.emit("down",this._downKeys[t]);this._pressedKeys.length=0,this._releasedKeys.length=0},e.prototype.getHotKey=function(e){var t=this._hotKeys[e]||new HotKey_1.HotKey(e,this);return this._hotKeys[e]=t},e.prototype.removeHotKey=function(e){this._hotKeys[e]&&delete this._hotKeys[e]},e=__decorate([typescript_ioc_1.Singleton,__metadata("design:paramtypes",[])],e)}(PIXI.utils.EventEmitter);exports.KeyboardManager=KeyboardManager;