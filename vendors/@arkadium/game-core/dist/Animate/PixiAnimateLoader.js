"use strict";
/*!@license
 * Copyright (c) Arkadium Inc - All Rights Reserved
 * Unauthorized copying of this file, via any medium is strictly prohibited
 * Proprietary and confidential
 * Written by Denis Gusarov <denis.gusarov@arkadium.com>
 */var __decorate=this&&this.__decorate||function(t,e,a,i){var r,s=arguments.length,n=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,a):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,i);else for(var o=t.length-1;0<=o;o--)(r=t[o])&&(n=(s<3?r(n):3<s?r(e,a,n):r(e,a))||n);return 3<s&&n&&Object.defineProperty(e,a,n),n},__metadata=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(exports,"__esModule",{value:!0});var PixiAnimateFactory_1=require("./factories/PixiAnimateFactory"),Library_1=require("./Library"),GamePerformance_1=require("../GamePerformance"),PixiAnimateLoader=function(){function t(t){this._data=t,this.library=new Library_1.Library(this._data),this.debug=!0,this.animate=new PixiAnimateFactory_1.PixiAnimateFactory,this.animate.__name=this.library.stage.name}return t.prototype.exportAssets=function(){var e={};if(this.library.bitmaps.forEach(function(t){e[t.name]=t.src}),this.library.sounds.forEach(function(t){e[t.name]=t.src}),this._data._meta.spritesheets&&this._data._meta.spritesheets.bitmaps)for(var t=0;t<this._data._meta.spritesheets.bitmaps.length;t++){var a=this._data._meta.spritesheets.bitmaps[t].data;this.animate.__spritesheets.push({data:a})}if(this._data._meta.spritesheets&&this._data._meta.spritesheets.shapes)for(t=0;t<this._data._meta.spritesheets.shapes.length;t++){a=this._data._meta.spritesheets.shapes[t].data;this.animate.__shapesheets.push({data:a})}this.animate.__assets=e},t.prototype.destroy=function(){this._data=null,this.library.destroy(),this.library=null},t.prototype.getInstance=function(t){var e=this.animate[t||this._data._meta.stageName];if(!e)throw"can't find library item with name = "+t;var a=e.getInstance({});for(var i in this.animate){var r=this.animate[i];r.reset&&r.reset()}return a},t.prototype.build=function(){var e=this;this.exportAssets(),this.library.timelines.forEach(function(t){try{t.render(e.animate)}catch(t){console.error("build error",t)}})},__decorate([GamePerformance_1.GamePerformanceMethod("PixiAnimateLoader","getInstance"),__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",void 0)],t.prototype,"getInstance",null),t}();exports.PixiAnimateLoader=PixiAnimateLoader;