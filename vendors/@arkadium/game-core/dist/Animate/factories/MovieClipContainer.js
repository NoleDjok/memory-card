"use strict";
/*!@license
 * Copyright (c) Arkadium Inc - All Rights Reserved
 * Unauthorized copying of this file, via any medium is strictly prohibited
 * Proprietary and confidential
 * Written by Denis Gusarov <denis.gusarov@arkadium.com>
 */var __extends=this&&this.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var MovieClip_1=require("../pixi/MovieClip"),MovieClipContainer=function(e){function n(t){var i=e.call(this)||this;return i._instanceId=0,i.___scripts=[],i.___children=[],i.__destroyed=!1,i._removeChildrenMask=function(t){for(var e=0;e<i.children.length;e++){var n=i.children[e];n.mask==t&&(n.mask=null)}},i}return __extends(n,e),n.prototype.update=function(t){for(var e=0;e<this.children.length;e++)this.children[e]instanceof n&&this.children[e].update(t);this._applyChildrenSorted()},n.prototype._applyChildrenSorted=function(){var n=this;if(this.__childrenSorted){var i=new PIXI.Container,t=function(){for(var t=n.children.indexOf(i);t<n.children.length;t++){var e=n.children[t];n.swapChildren(i,e)}};this.addChild(i);for(var e=0;e<this.__childrenSorted.length;e++){var r=this.__childrenSorted[e];this.swapChildren(i,r),t()}this.removeChild(i),this.__childrenSorted=null}},n.prototype.renderOrderedItems=function(r){var o=this,t=function(t,e,n){for(;!(t instanceof PIXI.Graphics||t instanceof PIXI.Sprite);){if(!(t.children&&0<t.children.length)){t=null;break}t=t.children[0]}for(var i=e-1;0<=i;i--){var r=o.children[i];if(r.mask=t,r._instanceId==n)return}},e=function(t){for(var e=0,n=r.length;e<n;e++){var i=r[e];if(i._placeAfter==t)return r.splice(e,1),i}return null},n=function(t){for(var e=0;e<o.children.length;e++){if(o.children[e]._instanceId==t)return e}return-1},i=e(0);i&&(0==this.children.length?this.addChild(i):this.addChildAt(i,this.children.length),i.mode===MovieClip_1.MovieClip.INDEPENDENT&&i.autoReset&&i._reset());for(var l=0;l<this.children.length;){var h=e(this.children[l]._instanceId);h?(0==this.children.length?this.addChild(h):this.addChildAt(h,l),l=0):l++}for(var d=0;d<r.length;){var s=r[d],_=n(s._placeAfter);0<=_?(0==this.children.length?this.addChild(s):this.addChildAt(s,_),r.splice(d,1),d=0):d++}for(d=0;d<r.length;){var a=r[d];this.addChild(a),r.splice(d,1),d=0}for(var c=0;c<this.children.length;c++){var p=this.children[c];0<p._maskTill&&t(p,c,p._maskTill)}},n.prototype.destroy=function(t){e.prototype.destroy.call(this,t)},n.prototype.getChild=function(t,e,n){void 0===n&&(n=0);for(var i=e.___children,r=null,o=0;o<i.length;o++)if(i[o].name==t[n])return r=i[o],n++,t.length==n?r:this.getChild(t,r,n);return r},n.prototype.gotoAndPlayChild=function(t,e,n,i){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===i&&(i=!0);var r=t.split("."),o=this.getChild(r,this);if(o.loop=n,o.gotoAndPlay(e),i){var l=o._labelDict[e]||e;if(o.___children&&o.___children.length)for(var h=o.___children,d=0;d<h.length;d++){var s=h[d];s.gotoAndPlay&&s.gotoAndPlay(l),this._gotoAndPlayAllChildren(l,s)}}},n.prototype._gotoAndPlayAllChildren=function(n,t,i){if(t.___children&&t.___children.length)for(var r=t.___children,e=function(t){var e=r[t];if(e.gotoAndPlay){if(i&&i.Any(function(t){return t!=e.name}))return"continue";e.gotoAndPlay(n)}o._gotoAndPlayAllChildren(n,e)},o=this,l=0;l<r.length;l++)e(l)},n.prototype.gotoAndStopAllChild=function(t){void 0===t&&(t=0),this._gotoAndStopAllChildren(t,this)},n.prototype.gotoAndStopChild=function(t,e){void 0===e&&(e=0);var n=t.split(".");this.getChild(n,this).gotoAndStop(e)},n.prototype._gotoAndStopAllChildren=function(t,e){if(e.___children&&e.___children.length)for(var n=e.___children,i=0;i<n.length;i++){var r=n[i];r.gotoAndStop&&(r.gotoAndStop(t),this._gotoAndStopAllChildren(t,r))}},n.prototype.onEvent=function(t,e,n){this.__$eventListeners_=this.__$eventListeners_||{},this.__$eventListeners_[t]=this.__$eventListeners_[t]||[],this.__$eventListeners_[t].push({callback:e,context:n||this})},n.prototype.offEvent=function(t,e){this.__$eventListeners_=this.__$eventListeners_||{};for(var n=this.__$eventListeners_[t]||[],i=0;i<n.length;i++)if(n[i].callback===e)return void n.splice(i,1)},n.prototype.triggerEvent=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.__$eventListeners_=this.__$eventListeners_||{};for(var i=this.__$eventListeners_[t]||[],r=0;r<i.length;r++)i[r].callback.apply(i[r].context,Array.prototype.slice.call(arguments,1))},n}(PIXI.Container);exports.MovieClipContainer=MovieClipContainer;